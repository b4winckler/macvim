Test for Japanese.

Note: In the :source! script, you can not write some multi-byte
character which have 0x80 byte (e.g. U+3000 UTF8:E3 80 80).  Use
<C-V>u3000.  0x80 is a CSI byte and it is used to represent a special
key-code (e.g. <Left>).  To see how key-code and multi-byte character
are stored in the memory, use -w argument.

Results of test3:

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqo
ã‚ã„ã†ãˆãŠu3002ã‹ããã‘ã“
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
gqgqo
ã‚ã„ã†ãˆãŠu3002ã‹ããã‘ã“
ENDTEST

1254595249
{
ã‚ã„ã†ãˆãŠã€‚ã‹ããã‘ã“
}
{
ã‚ã„ã†ãˆãŠã€‚ã‹ããã‘ã“
}

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqo
ã‚ã„ã†ãˆu3002u3002ã‹ãã
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
gqgqo
ã‚ã„ã†ãˆu3002u3002ã‹ãã
ENDTEST

1254595243
{
ã‚ã„ã†ãˆã€‚ã€‚ã‹ãã
}
{
ã‚ã„ã†ãˆã€‚ã€‚ã‹ãã
}

STARTTEST
:set tw=2 fo=tm
/^{/+1
:set formatexpr=
gqgqo
  ã‚u3002
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
gqgqo
  ã‚u3002
ENDTEST

1254595244
{
  ã‚ã€‚
}
{
  ã‚ã€‚
}

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqo
ã‚ã„ã†ãˆu300cãŠ
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
gqgqo
ã‚ã„ã†ãˆu300cãŠ
ENDTEST

1254595245
{
ã‚ã„ã†ãˆã€ŒãŠ
}
{
ã‚ã„ã†ãˆã€ŒãŠ
}

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqo
ã‚ã‚ã‚ã‚ã‚u3002ã„ã„ã„
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
:let b:autofmt_allow_over_tw = 2
gqgqo
ã‚ã‚ã‚ã‚ã‚u3002ã„ã„ã„
:unlet b:autofmt_allow_over_tw
ENDTEST

1254595246
{
ã‚ã‚ã‚ã‚ã‚ã€‚ã„ã„ã„
}
{
ã‚ã‚ã‚ã‚ã‚ã€‚ã„ã„ã„
}

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqo
ã‚ã‚ã‚ã‚ã‚u3002ã„ã„ã„
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
:let b:autofmt_allow_over_tw = 1
gqgqo
ã‚ã‚ã‚ã‚ã‚u3002ã„ã„ã„
:unlet b:autofmt_allow_over_tw
ENDTEST

1254595248
{
ã‚ã‚ã‚ã‚ã‚ã€‚ã„ã„ã„
}
{
ã‚ã‚ã‚ã‚ã‚ã€‚ã„ã„ã„
}

STARTTEST
:set tw=10 fo=tm
/^{/+1
:set formatexpr=
gqgqjgqgqo
ã‚ã„ã†ãˆu3002abcd
ã‚ã„ã†ãˆu3002u300d
/^{/+1
:set formatexpr=autofmt#japanese#formatexpr()
gqgqjgqgqo
ã‚ã„ã†ãˆu3002abcd
ã‚ã„ã†ãˆu3002u300d
ENDTEST

1295124892
{
ã‚ã„ã†ãˆã€‚abcd
ã‚ã„ã†ãˆã€‚ã€
}
{
ã‚ã„ã†ãˆã€‚abcd
ã‚ã„ã†ãˆã€‚ã€
}

STARTTEST
:g/^STARTTEST/.,/^ENDTEST/d
:1;/^Results/,$wq! test.out
ENDTEST
